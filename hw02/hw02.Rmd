---
title: "hw02: Exploring Gapminder with dplyr"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(gapminder)
library(DT)
library(knitr)
library(ggplot2)
```

## Exercise 1: Basic `dplyr`
### 1.1
Subset gapminder into three countries of choice in the 1970s using `filter()`.

```{r}
knitr::kable(gapminder %>% 
    filter(year < 1980 & year > 1970,
         country == 'Morocco' | country == 'Iran' | country == 'Japan'))
  
```



### 1.2
Select `country` and `gdpPercap` using piping from filtered dataset.

```{r}
knitr::kable(gapminder %>% 
    filter(year < 1980 & year > 1970,
         country == 'Morocco' | country == 'Iran' | country == 'Japan') %>% 
    select(country, gdpPercap))
```

### 1.3
Create a new variable in gapminder showing differences in life expectancy in a country. Select any countries that have experienced a drop in life expectancy.

```{r}
DT::datatable(gapminder %>% 
                group_by(country) %>% 
                mutate(lifeExpDiff = lifeExp-lag(lifeExp)) %>% 
                filter(lifeExpDiff < 0))
        
```

### 1.4
Organize gapminder to contain the max GDP per capita experienced by each country.

```{r}
DT::datatable(gapminder %>% 
               group_by(country) %>% 
               filter(gdpPercap == max(gdpPercap)))

```

### 1.5
Create a scatter plot of Canada's life expectancy vs GDP per capita.

```{r}
gapminder %>% 
  filter(country == 'Canada') %>% 
  ggplot(aes(x = lifeExp, y = gdpPercap))+
    geom_point() +
    labs(
      x = "Life Expectancy",
      y = "GDP per capita",
      title = "Canada's Life Expectancy vs GDP Per Capita"
    )
```

